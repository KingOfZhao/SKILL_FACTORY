---
name: 元-skill-问题穷举器
description: 对任何问题进行无限横竖穷举「物理实践」或「最小Skill树」，上下文即将满额时自动保存穷举节点，下次无缝继续。
---

# 无限物理实践/Skill树穷举器（优化版 v1.1）

## Capabilities（单一职责）
- 接收「我的问题」描述
- 进行树状无限穷举：横向（同层多种实践）、纵向（基础→进阶→极端）
- **双模式支持**：物理实践 / 最小 Skill 树
- 每轮输出有限 chunk（5-15 个实践），+ 结构化 checkpoint
- 上下文即将满额时自动保存节点并停止
- 下次调用自动从 checkpoint 继续

## 执行前必须读取
common/underlying-convention.md

## MCP 依赖声明（重要）

**必须预先连接文件系统 MCP（local-files 或 filesystem），否则无法保存/恢复节点。**

首次执行时会检测 MCP 可用性，如未连接将提示：
> 文件系统 MCP 未连接，无法创建 checkpoint。请先在 Claude Code 设置中添加 MCP server（如 `claude mcp add filesystem`）。是否继续无 checkpoint 模式？（y/n）

## 启动前强制询问（必须执行）

### 触发条件
- 首次运行
- checkpoint 文件不存在或已清空
- 用户明确要求重新选择模式
- 用户输入"继续"但 checkpoint 过期（> 24小时）

### 询问模板（必须原样输出）

> 请先明确你要穷举的模式（回复数字或关键词即可）：
>
> 1. **物理实践穷举**
>    → 真实世界可动手、可观察的具体物理行动、实验、材料使用、流程操作等。
>
> 2. **最小 Skill 树实践穷举**
>    → 针对 Skill 体系的最小化定义、拆分树、单一职责模块、依赖关系等。
>
> 请输入 1 或 2（或对应关键词），我才会开始穷举你的问题：[你的问题描述]

### 模式匹配规则（宽松匹配）

- `1` / `1` / `one` / `物理实践` / `physical` / `物` / `实践` / `动手` → 物理实践模式
- `2` / `2` / `two` / `skilltree` / `skill树` / `skill` / `树` / `体系` → 最小 Skill 树模式
- 其他 → 重复询问一次，不开始穷举
- 已有对应 checkpoint → 自动加载并继续（跳过询问），回复：
  > 检测到 [物理实践 / 最小 Skill 树] checkpoint，继续从节点 X 穷举。

## Input Specification（横竖穷举）

### 横向
- 纯自然语言问题描述
- 带历史上下文的问题
- 带约束的问题（"预算<100元""只能用家里物品"）

### 纵向
- 最原始：模糊一句话
- 结构化：问题 + 已知约束 + 上次 checkpoint
- 边缘：空输入 / 矛盾约束 → 直接拒绝并要求澄清

## Output Specification（分模式）

### 物理实践模式输出模板

每轮必须包含：

1. **实践列表**（5-15 个），每个实践包含：
   - 编号
   - 标题
   - 描述
   - 执行步骤（1-2-3...）
   - 所需材料
   - 预期观察（物理反馈：重量、时间、声音、温度、视觉变化等）
   - 安全注意事项
   - 耗时估算
   - 成本估算

2. **树状结构预览**（ASCII 树）
   ```
   问题
   ├─ 变体 1 (当前)
   │  ├─ 基础层
   │  └─ 进阶层
   └─ 变体 2
   ```

3. **checkpoint 文件路径**
   `enumeration_checkpoint_physical.json`

4. **10 分钟验证指南**（见下方）

### 最小 Skill 树模式输出模板

每轮必须包含：

1. **Skill 列表**（5-15 个），每个 Skill 包含：
   - 编号
   - Skill 名称（kebab-case）
   - 单一职责描述
   - 输入规范（类型、格式）
   - 输出规范（类型、格式）
   - 依赖 Skill 列表
   - 潜在 MCP 需求（如需要）
   - 10 分钟验证方式

2. **树状结构预览**（ASCII 树）
   ```
   目标
   ├─ 根 Skill (当前)
   │  ├─ 子 Skill A
   │  └─ 子 Skill B
   └─ 替代方案
   ```

3. **checkpoint 文件路径**
   `enumeration_checkpoint_skilltree.json`

4. **10 分钟验证指南**（见下方）

## Checkpoint 机制（核心）

### 文件分离
- 物理实践模式：`enumeration_checkpoint_physical.json`
- 最小 Skill 树模式：`enumeration_checkpoint_skilltree.json`

### 格式（带版本控制）
```json
{
  "version": 1,
  "mode": "physical" | "skilltree",
  "problem": "用户原始问题",
  "current_node": "level-2.branch-3",
  "enumerated_so_far": ["实践1", "实践2"],
  "next_pending_branches": ["branch-4", "branch-5"],
  "timestamp": "ISO8601",
  "created_at": "ISO8601",
  "previous_version_file": "enumeration_checkpoint_physical_v0.json"
}
```

### 保存触发条件（保守估计）
由于无法直接获取上下文剩余量，采用以下策略：
- **每输出 5-10 个实践节点**后，提示用户："已输出 X 个实践，如感觉上下文快满了，请回复「保存」或「继续」"
- 用户明确回复"保存" → 立即保存 checkpoint
- 用户回复"继续" → 继续输出下一批

### 保存后回复
> 节点已保存到 [文件路径]，下次输入任意内容即可继续。

### 保存失败处理
如果保存失败（权限/MCP 未连接），回复：
> 保存失败：无写权限 / MCP 未连接。节点已丢失，请手动复制本次输出保存。

## 上下文管理

### 手动触发
用户可随时输入：
- `保存` - 强制保存当前进度
- `检查上下文` - 显示估算的上下文状态
- `切换模式` - 重新选择模式（会重置 checkpoint）

### 建议辅助
推荐安装 Claude Code Usage Tracker 扩展（状态栏实时显示 %），但 Skill 本身无法读取该数据。

## 强制 10 分钟验证原则

### 快速验证指南

1. 打开项目文件夹 → 查看 `enumeration_checkpoint_*.json`（<10秒）
2. 阅读本次输出的实践/Skill 列表（3分钟）
3. 任选 1 个实践/Skill，按步骤手动尝试（5分钟内可观察结果）
4. 对比输出描述与实际结果 → 判断正确性（<1分钟）

**总耗时 ≤ 10 分钟**

成功标志：checkpoint 文件已更新且至少 1 个实践可立即动手验证。

## Limitations（必须声明）

- 本 Skill 只负责「物理实践」或「最小 Skill 树」的无限穷举，不负责代码实现、理论分析、实际执行或结果解读
- 每次仅输出有限 chunk，无法一次性穷举完
- **必须预先连接文件系统 MCP（local-files 或 filesystem），否则无法保存/恢复节点**
- 若用户问题过于抽象，物理实践模式可能输出偏向"可动手实验"而非纯物理
- 最小 Skill 树模式仅输出结构建议，不生成实际代码
- **上下文检测为保守估计**：建议依赖用户手动监控或安装 Usage Tracker 扩展
- 虽名为"无限"穷举，但实际受 checkpoint 文件大小、磁盘空间、Claude 会话时长等物理限制，无法真正无限

## 使用方法

### 基本用法
```
无限穷举器：[我的问题]
```

### 继续上轮
```
继续
```
或再次输入同一个问题。

### 切换模式
```
切换模式
```
会弹出模式选择，并重置 checkpoint。

### 手动保存
```
保存
```
强制保存当前进度到 checkpoint。

### 示例流程
```
用户：用无限穷举器穷举：如何在家里用最简单材料验证重力加速度

AI：（首次，弹出模式选择）
请先明确你要穷举的模式（回复数字或关键词即可）：
1. 物理实践穷举...
2. 最小 Skill 树实践穷举...
请输入 1 或 2...

用户：1

AI：好的，进入物理实践模式，开始穷举"如何在家里用最简单材料验证重力加速度"...

[输出第一批实践 + checkpoint]

用户：继续

AI：检测到物理实践 checkpoint，继续从节点 level-2.branch-3 穷举...

[输出下一批实践 + 更新 checkpoint]

用户：保存

AI：节点已保存到 enumeration_checkpoint_physical.json，下次输入任意内容即可继续。
```
