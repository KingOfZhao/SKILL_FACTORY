# 认知更新提案（skill-generator 自我精炼）

## 生成时间
2026-02-26

## 本次生成对象
**skill-修复器** (Skill-Fixer)

---

## 新增结构化认知

### 1. 元认知模式

| 模式名称 | 描述 | 适用场景 |
|---------|------|---------|
| 诊断闭环 | 诊断 → 修复 → 验证完整闭环 | 所有修复/优化类 Skill |
| 标准化输出 | diagnosis.json + fix-plan.md + verification.json | 需要结构化输出的场景 |
| 安全边界 | 禁止自身修复、禁止修改底层约定 | 修改类、修复类 Skill |

### 2. 检测维度模式（可复用）

修复类 Skill 的标准化检测维度：

```yaml
检测维度:
  - 结构完整性:
      - 必需文件检查 (SKILL.md, description.md)
      - 命名约定检查 (kebab-case)
  - 语法格式:
      - YAML 语法
      - JSON 格式
  - 约定遵守:
      - SKILL.md 行数限制 (400行)
      - 脚本错误处理
  - 工具调用:
      - 工具存在性
      - 参数合法性
  - 输出验证:
      - 文件可读性
      - 结构完整性
```

### 3. 脚本模式

Bash 脚本的最佳实践模式：

```bash
# 1. 严格模式
set -euo pipefail

# 2. 颜色输出定义
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

# 3. 可配置参数
APPLY_FIX=false
VERBOSE=false
OUTPUT_DIR="output"

# 4. 自身保护（禁止修复自身）
if [[ "$(cd "$TARGET" && pwd)" == "$(cd "$SCRIPT_DIR/.." && pwd)" ]]; then
    exit 1
fi

# 5. 结构化输出
echo '{"key": "value"}' > output.json
```

---

## 对底层约定的潜在影响

### 无需修改项
- `underlying-convention.md` 已覆盖所有核心规则
- 本 skill 的安全边界符合约定要求

### 可选增强建议（需人工确认）

以下建议**不自动应用**，仅供参考：

1. **约定增强**：建议在 `underlying-convention.md` 中明确 "修复类 Skill 必须禁止自身修复"

2. **输出标准化**：建议定义统一的诊断输出格式规范

3. **工具检测清单**：建议维护一个标准工具列表用于合法性检查

---

## 认知积累状态

| 类别 | 数量 | 说明 |
|-----|------|------|
| 元认知模式 | 3 | 诊断闭环、标准化输出、安全边界 |
| 检测维度 | 5 | 结构、语法、约定、工具、验证 |
| 脚本模式 | 5 | 严格模式、颜色输出、参数化等 |

---

## 后续行动建议

### 短期（本次生成后）
- [ ] 人工审查本次生成的 skill-修复器
- [ ] 测试修复功能是否正常工作
- [ ] 验证输出格式是否符合预期

### 中期（多次生成后）
- [ ] 当 overlaps 积累到足够多时，提炼为"通用基础 Skill"
- [ ] 建立检测维度模板库
- [ ] 标准化各类 Skill 的输出格式

### 长期（持续迭代）
- [ ] 建立自动化测试验证生成的 Skill
- [ ] 根据 overlaps 模式更新底层约定（如需）
- [ ] 实现认知的自动应用机制
